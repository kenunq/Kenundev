{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>WoW model viewer</title>
<!--    <base href="http://subdomain.domain.com/subdirectory/">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1">-->
<!--    <link rel="icon" type="image/x-icon" href="favicon.ico">-->
    <script crossorigin="anonymous" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://wow.zamimg.com/modelviewer/wrath/viewer/viewer.min.js"></script>
    <script src="{% static 'js/wow-model-viewer/index.js' %}"></script>
    <link href="https://fonts.cdnfonts.com/css/lifecraft" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

<link rel="stylesheet" href="//wow.zamimg.com/modelviewer/viewer/viewer.css" type="text/css"><link rel="stylesheet" href="//wow.zamimg.com/modelviewer/viewer/viewer.css" type="text/css"><link rel="stylesheet" href="//wow.zamimg.com/modelviewer/viewer/viewer.css" type="text/css"></head>
<body class="">
<h1>
    WoW model viewer
</h1>
<div class="model_3d" id="model_3d1" style="height: 381px; position: relative;"><h2>My Character</h2><canvas width="380.797" height="381"></canvas><div style="position: absolute; bottom: 0px; left: 0px; right: 0px; height: 10px; background-color: rgb(0, 0, 0); display: none;"></div><div style="position: absolute; bottom: 0px; left: 0px; width: 381px; height: 10px; background-color: rgb(204, 204, 204); display: none;"></div></div>
<div class="model_3d" id="model_3d2" style="height: 381px; position: relative;"><h2>Atiesh GreatClock of the guardian</h2><canvas width="380.797" height="381"></canvas><div style="position: absolute; bottom: 0px; left: 0px; right: 0px; height: 10px; background-color: rgb(0, 0, 0); display: none;"></div><div style="position: absolute; bottom: 0px; left: 0px; width: 381px; height: 10px; background-color: rgb(204, 204, 204); display: none;"></div></div>
<div class="model_3d" id="model_3d3" style="height: 381px; position: relative;"><h2>Rotation</h2><canvas width="380.797" height="381"></canvas><div style="position: absolute; bottom: 0px; left: 0px; right: 0px; height: 10px; background-color: rgb(0, 0, 0); display: none;"></div><div style="position: absolute; bottom: 0px; left: 0px; width: 381px; height: 10px; background-color: rgb(204, 204, 204); display: none;"></div></div>
<div>
    <div>
        <button onclick="randAnimation(window.model1)">Random animation</button>
    </div>
    <div>
        <button onclick="randAnimation(window.model3)">Arthas random animation</button>
    </div>
    <div>
        <button onclick="pauseAnimation()">Pause animation</button>
    </div>
    <div>
        <button onclick="fullScreen()">Full Screen</button>
    </div>
    <div>
        <button onclick="changeDirection()">Change rotation</button>
    </div>
    <div class="fullscrin">
        <button onclick="fullScreen()">Full Screen</button>
    </div>

    <div class="clearSlots">
        <button onclick="clearSlot(3)">Clear slots(3)</button>
    </div>

    <div class="setItems">
        <button onclick="setItems(3, 65197, 0)">setItem</button>
    </div>
</div>
<div>
    <a href="https://github.com/Miorey/wow-model-viewer">GitHub</a>
    <a href="https://www.npmjs.com/package/wow-model-viewer">npm</a>
</div>

<style>
    body {
        background: #333;
        color: #fff;
        font-family: 'Open Sans', sans-serif;
    }

    .model_3d {
        width: 20%;
        background: #333;
        float: left;
    }
    h1, h2, h3, h4, h5 {
        font-family: 'LifeCraft', sans-serif;
        color: #000;
        text-shadow: 0 0 2px #f9c811, 0 0 2px #f9c811, 0 0 2px #f9c811, 0 0 2px #f9c811;
        text-align: center;
    }

    h1 {
        bottom: 0;
        left: 58px;
    }
    button, a {
        color: #d3b359;
        text-shadow: -2px 0 #000, 0 2px #000, 1px 0 #000, 0 -2px #000;
        font-weight: bold;
        background: #7d0b0c;
        background: -webkit-radial-gradient(#7d0b0c 30%, #4e0c0b 60%);
        background: -o-radial-gradient(#7d0b0c 30%, #4e0c0b 60%);
        background: -moz-radial-gradient(#7d0b0c 30%, #4e0c0b 60%);
        background: radial-gradient(#7d0b0c 30%, #4e0c0b 60%);
        border: 2px solid #26160c;
        transition: text-shadow 0.5s, color 0.5s, border-color 0.5s, box-shadow 0.5s, background 0.5s;
        -webkit-transition: text-shadow 0.5s, color 0.5s, border-color 0.5s, box-shadow 0.5s, background 0.5s;
        -moz-transition: text-shadow 0.5s, color 0.5s, border-color 0.5s, box-shadow 0.5s, background 0.5s;
        -o-transition: text-shadow 0.5s, color 0.5s, border-color 0.5s, box-shadow 0.5s, background 0.5s;
        margin: 4px;
    }
    button:hover, a:hover {
        color: #f9c811;
        text-shadow: -2px 0 #000, 0 2px #000, 1px 0 #000, 0 -2px #000;
    }
    code {
        display: block;
        margin-top: 5px;
        margin-bottom: 5px;
    }
    a {
        text-decoration: none;
        display: inline-block;
        padding: 3px;
        font-size: 1.25em;
    }
</style>

<script type="module">
    import {generateModels} from "{% static 'js/wow-model-viewer/index.js' %}";

    const character = {
        "race": 7,
        "gender": 1,
        "skin": 4,
        "face": 0,
        "hairStyle": 5,
        "hairColor": 5,
        "facialStyle": 5,
        "items": [[1, 1170], [3, 4925], [5, 9575], [6, 25235], [7, 2311], [8, 21154], [9, 14618], [10, 9534], [15, 17238], [21, 20379], [22, 28787]]
    };

    window.model1 = await generateModels(1, `#model_3d1`, character);
    window.model2 = await generateModels(1, `#model_3d2`, {type: 1, id: 193841});
    window.model3 = await generateModels(1, `#model_3d3`, {type: 8, id: 24949});
    setInterval(() => {
        const date = new Date;
        window.model2.setAzimuth(2 * Math.PI * (date.getSeconds() / 60))
        window.model2.setZenith(Math.PI)
    }, 1000)

    let angle = 0
    let direction = 10
    setInterval(() => {
        if (Math.abs(angle) >= 2000000) {
            angle = 0
        }
        angle += direction
        window.model3.setAzimuth(2 * Math.PI * (angle / 10000))
        window.model2.setZenith(Math.PI)
    }, 1)

    /**
     *
     * @param model {WowModelViewer}
     */
    window.randAnimation = (model) => {
        const animationList = model.getListAnimations()
        const random = Math.floor(Math.random() * animationList.length);
        model.setAnimation(animationList[random])
    }

    window.pauseAnimation = () => {
        window.isPaused = !window.isPaused
        window.model1.setAnimPaused(window.isPaused)
        window.model3.setAnimPaused(window.isPaused)
    }

    window.fullScreen = () => {
        window.model1.setFullscreen(true)
    }


    window.changeDirection = () => {
        direction = -1 * direction
    }

    window.fullScreen = () => {
        window.model1.setFullscreen(true)
    }

    window.clearSlot = (s) => {
        window.model1.renderer.viewer.method("clearSlots", String(s))
    }

    window.setItems = (e, t, i) => {
        console.log(window.model1.renderer.viewer.method("setItems", [[{
                slot: e,
                display: t,
                visual: i
            }]]))
    }

</script>

</body>
</html>